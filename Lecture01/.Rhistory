max(density)
lines(c(1,1),c(-0.1,0.4))
lines(c(1,1),c(-0.1,0.399))
plot(x,density,"l",xaxt='n',yaxt='n',ylab='',xlab='μ')
lines(c(1,1),c(-0.1,0.399))
plot(x,density,"l",xaxt='n',yaxt='n',ylab='',xlab='μ')
lines(c(1,1),c(-0.1,0.4))
plot(x,density,"l",xaxt='n',yaxt='n',ylab='',xlab='μ')
lines(c(1,1),c(-0.1,0.41))
plot(x,density,"l",xaxt='n',yaxt='n',ylab='',xlab='μ')
lines(c(1,1),c(-0.1,0.405))
shiny::runApp('Documents/Teaching/OLS')
pnorm(0.43,0,1)
pnorm(30,27,7)
pnorm((30-27)/7,0,1)
pnorm(30,27,7)
choose(2,10)
choose(10,2)
1-pexp(0.11)
1-pexp(10,0.11)
ppois(6,5)
pbinom(8,11,0.1)
pbinom(1,11,0.1)
pbinom(2,11,0.1)
6/sqrt(76)
qnorm(0.99)
qnorm(0.99)*(6/sqrt(76))
1.6/(6/sqrt(76))
pnorm(1.6/(6/sqrt(76)))
1-pnorm(1.6/(6/sqrt(76)))
1.6/(6/sqrt(76))
1/(1.6/(6/sqrt(76)))
1/1.6
p(0.99)
pnorm(0.99)
pnorm(0.99)/1.6
qnorm(0.99)/1.6
1.6/qnorm(0.99)
pnorm(-2)
sqrt(200-25/199)
sqrt((200-25)/199)
sqrt((200-25)/199)*2
pnorm(2/sqrt((200-25)/199))
pnorm(-2/sqrt((200-25)/199))
x<-c(1,2,3,4)
y<-c(7,6,4,1)
lm(y~x)
install.packages('tscounts')
data(package='tscounts')
data(package='tscount')
install.packages('tscount')
data(package='tscount')
measles
library(tscount)
measles
campy
ecoli
ehec
influenza
5*5*5*5*20
setwd("~/Documents/Teaching/AMSI/Lecture01")
xaringan::summon_remark()
options(htmltools.dir.version = FALSE)
wb<-read_csv('data/WorldBank.csv)
'
wb<-read_csv('data/WorldBank.csv')
library(tidyverse)
library(tidyverse)
wb<-read_csv('data/WorldBank.csv')
View(wb)
wb%>%
select(Country=`Country Code`,Series=`Series Code`,Value=`2015 YR[2015]`)%>%
pivot_wider(id_cols = Country,names_from = Series,values_from=Value)%>%View
wb%>%
select(Country=`Country Code`,Series=`Series Code`,Value=`2015 [YR2015]`)%>%
pivot_wider(id_cols = Country,names_from = Series,values_from=Value)%>%View
apply(wb_rs,1,function(x){sum(is.na(x))})
wb%>%
select(Country=`Country Code`,Series=`Series Code`,Value=`2015 [YR2015]`)%>%
pivot_wider(id_cols = Country,names_from = Series,values_from=Value)->wb_rs
apply(wb_rs,1,function(x){sum(is.na(x))})
apply(wb_rs,2,function(x){sum(is.na(x))})
wb<-read_csv('data/WorldBank.csv',na = '..')
wb%>%
select(Country=`Country Code`,Series=`Series Code`,Value=`2015 [YR2015]`)%>%
pivot_wider(id_cols = Country,names_from = Series,values_from=Value)->wb_rs
wb
View(wb)
wb<-read_csv('data/WorldBank.csv',na = '..',n_max = 53064)
wb%>%
select(Country=`Country Code`,Series=`Series Code`,Value=`2015 [YR2015]`)%>%
pivot_wider(id_cols = Country,names_from = Series,values_from=Value)->wb_rs
apply(wb_rs,1,function(x){sum(is.na(x))})
apply(wb_rs,1,function(x){sum(is.na(x))})%>%sort()
wb<-read_csv('data/WorldBank.csv',na = '..',n_max = 53064)
wb%>%
select(Country=`Country Code`,Series=`Series Code`,Value=`2015 [YR2015]`)%>%
pivot_wider(id_cols = Country,names_from = Series,values_from=Value)->wb_rs
mis<-apply(wb_rs,1,function(x){sum(is.na(x))})
k<-100
wb_rs<-wb_rs[,(mis<k)]
mis<-apply(wb_rs,2,function(x){sum(is.na(x))})
k<-100
wb_rs<-wb_rs[,(mis<k)]
wb_rs
View(wb_rs)
library(tidyverse)
wb<-read_csv('data/WorldBank.csv',na = '..',n_max = 53064)
wb%>%
select(Country=`Country Code`,Series=`Series Code`,Value=`2015 [YR2015]`)%>%
pivot_wider(id_cols = Country,names_from = Series,values_from=Value)->wb_rs
mis<-apply(wb_rs,2,function(x){sum(is.na(x))})
k<-100
wb_sel<-wb_rs[,(mis<k)]
wb_clean<-complete.cases(wb_sel)
wb_clean
wb_clean<-wb_sel[complete.cases(wb_sel),]
k<-80
wb_sel<-wb_rs[,(mis<k)]
wb_clean<-wb_sel[complete.cases(wb_sel),]
k<-60
wb_sel<-wb_rs[,(mis<k)]
wb_clean<-wb_sel[complete.cases(wb_sel),]
k<-65
wb_sel<-wb_rs[,(mis<k)]
wb_clean<-wb_sel[complete.cases(wb_sel),]
k<-60
wb_sel<-wb_rs[,(mis<k)]
wb_clean<-wb_sel[complete.cases(wb_sel),]
k<-50
wb_sel<-wb_rs[,(mis<k)]
wb_clean<-wb_sel[complete.cases(wb_sel),]
wb_clean
View(wb_clean)
wb<-read_csv('data/WorldBank.csv',na = '..',n_max = 43617)
wb
tail(wb)
wb%>%
select(Country=`Country Code`,Series=`Series Code`,Value=`2015 [YR2015]`)%>%
pivot_wider(id_cols = Country,names_from = Series,values_from=Value)->wb_rs
mis<-apply(wb_rs,2,function(x){sum(is.na(x))})
k<-50
wb_sel<-wb_rs[,(mis<k)]
wb_clean<-wb_sel[complete.cases(wb_sel),]
wb%>%
select(`Country Name`,`Country Code`,Series=`Series Code`,Value=`2015 [YR2015]`)%>%
pivot_wider(id_cols = 1:2,names_from = Series,values_from=Value)->wb_rs
mis<-apply(wb_rs,2,function(x){sum(is.na(x))})
k<-50
wb_sel<-wb_rs[,(mis<k)]
wb_clean<-wb_sel[complete.cases(wb_sel),]
wb_clean
wb%>%
select_if(.,is.numeric)%>%
scale()%>%
prcomp()->pca
library(knitr)
library(kableExtra)
wb<-read_csv('data/WorldBankClean.csv')
kable(wb,format = 'html')%>%
kable_styling(bootstrap_options = c("striped","hover","condensed"))%>%
scroll_box(height="300px")
wb%>%
select_if(.,is.numeric)%>%
scale()%>%
prcomp()->pca
wbPC<-augment(pca,wb)
library(broom)
wb%>%
select_if(.,is.numeric)%>%
scale()%>%
prcomp()->pca
wbPC<-augment(pca,wb)
wbPC
?ggplotly
?plotly::ggplotly
library(tidyverse)
library(broom)
wb<-read_csv('data/WorldBankClean.csv')
wb%>%
select_if(.,is.numeric)%>%
scale()%>%
prcomp()->pca
wbPC<-augment(pca,wb)
library(plotly)
wbPC%>%
ggplot(aes(x=.fittedPC1,y=.fittedPC2,label=`Country Code`,group=`Country Name`))+geom_text(size=3)->g1
ggplotly(g1,tooltip="group")
library(plotly)
library(widgetframe)
library(ggrepel)
wbPC%>%
ggplot(aes(x=.fittedPC1,y=.fittedPC2,label=`Country Code`,text=`Country Name`))+geom_point(size=0.5)+
geom_text(size=3)+xlab('Principal Component 1')+ylab('Principal Component 2')->g1
ggplotly(g1,dynamicTicks = T,tooltip="text")%>%
frameWidget(width="100%",height="100%")
library(plotly)
library(widgetframe)
library(ggrepel)
wbPC%>%
ggplot(aes(x=.fittedPC1,y=.fittedPC2,label=`Country Code`,text=`Country Name`))+geom_point(size=0.5,color='blue')+
geom_text(size=3)+xlab('Principal Component 1')+ylab('Principal Component 2')->g1
ggplotly(g1,dynamicTicks = T,tooltip="text")%>%
frameWidget(width="100%",height="100%")
library(plotly)
library(widgetframe)
library(ggrepel)
wbPC%>%
ggplot(aes(x=.fittedPC1,y=.fittedPC2,label=`Country Code`,text=`Country Name`))+geom_point(size=0.2,color='blue')+
geom_text(size=3)+xlab('Principal Component 1')+ylab('Principal Component 2')->g1
ggplotly(g1,dynamicTicks = T,tooltip="text")%>%
frameWidget(width="100%",height="100%")
library(plotly)
library(widgetframe)
library(ggrepel)
wbPC%>%
ggplot(aes(x=.fittedPC1,y=.fittedPC2,label=`Country Code`,text=`Country Name`))+geom_point(size=0.2,color='blue')+
geom_text(size=3,position = nudge_y=0.2)+xlab('Principal Component 1')+ylab('Principal Component 2')->g1
?nudge_y
?geom_text
library(plotly)
library(widgetframe)
wbPC%>%
ggplot(aes(x=.fittedPC1,y=.fittedPC2,label=`Country Code`,text=`Country Name`))+geom_point(size=0.2,color='blue')+
geom_text(size=3,nudge_y=0.2)+xlab('Principal Component 1')+ylab('Principal Component 2')->g1
ggplotly(g1,dynamicTicks = T,tooltip="text")%>%
frameWidget(width="100%",height="100%")
library(plotly)
library(widgetframe)
wbPC%>%
ggplot(aes(x=.fittedPC1,y=.fittedPC2,label=`Country Code`,text=`Country Name`))+geom_point(size=0.2,color='blue')+
geom_text(size=3,nudge_x=0.5)+xlab('Principal Component 1')+ylab('Principal Component 2')->g1
ggplotly(g1,dynamicTicks = T,tooltip="text")%>%
frameWidget(width="100%",height="100%")
cor(wb_clean)
cor(wb_clean%>%select_if(is.numeric))
cor(wb_clean%>%select_if(is.numeric))%>%which.max()
cor(wb_clean%>%select_if(is.numeric))%>%which.min()
cor(wb_clean%>%select_if(is.numeric))[1553]
cor(wb_clean%>%select_if(is.numeric))-diag(rep(1,67))%>%which.min()
(cor(wb_clean%>%select_if(is.numeric))-diag(rep(1,67))%>%which.min()
(cor(wb_clean%>%select_if(is.numeric))-diag(rep(1,67)))%>%which.min()
(cor(wb_clean%>%select_if(is.numeric))-diag(rep(1,65)))%>%which.min()
(cor(wb_clean%>%select_if(is.numeric))-diag(rep(1,65)))%>%which.max()
(cor(wb_clean%>%select_if(is.numeric))-diag(rep(1,65)))[%>%which.max()[2775]
(cor(wb_clean%>%select_if(is.numeric))-diag(rep(1,65)))[2775]
(cor(wb_clean%>%select_if(is.numeric)))%>%View
wb%>%
select(SH.DYN.MRT,SH.ANM.CHILD.ZS)-wbsimp #Use numeric data
wb
wb%>%
select(SH.DYN.NMRT,SH.ANM.CHLD.ZS)-wbsimp #Use numeric data
wb%>%
select(SH.DYN.NMRT,SH.ANM.CHLD.ZS)->wbsimp #Use numeric data
wb_simp%>%
scale()%>% #Standardise
prcomp()->pca #Compute PCs
wbsimp%>%
scale()%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
wbsimpPC
wb%>%
select(IT.MLT.MAIN.P2,FB.CBK.BRCH.P5)->wbsimp #Use numeric data
wbsimp%>%
scale()%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=IT.MLT.MAIN.P2,y=FB.CBK.BRCH.P5))+geom_point()
wb%>%
select(IT.MLT.MAIN.P2,FB.CBK.BRCH.P5)%>%
scale()->wbsimp #Use numeric data
wbsimp%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=IT.MLT.MAIN.P2,y=FB.CBK.BRCH.P5))+geom_point()
wb%>%
select(SP.DYN.LE00.FE.IN,FB.CBK.BRCH.P5)%>%
scale()->wbsimp #Use numeric data
wbsimp%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=SP.DYN.LE00.FE.IN,y=FB.CBK.BRCH.P5))+geom_point()
wb%>%
select(BN.GSR.GNFS.CD,IT.NET.BBND)%>%
scale()->wbsimp #Use numeric data
wbsimp%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=BN.GSR.GNFS.CD,y=IT.NET.BBND))+geom_point()
wb%>%
select(IP.JRN.ARTC.SC,IT.NET.BBND)%>%
scale()->wbsimp #Use numeric data
wbsimp%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=IP.JRN.ARTC.SC,y=IT.NET.BBND))+geom_point()
wb%>%select_if(is.numeric)%>%cor%>%View()
wb%>%
select(SP.DYN.LE00.FE.IN,FP.ATM.TOTL.P5)%>%
scale()->wbsimp #Use numeric data
wb%>%
select(SP.DYN.LE00.FE.IN,FB.ATM.TOTL.P5)%>%
scale()->wbsimp #Use numeric data
wbsimp%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=SP.DYN.LE00.FE.IN,y=FB.ATM.TOTL.P5))+geom_point()
library(ggpair)
library(ggpairs)
library(GGally)
ggpairs(select(wb,3:12))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:65,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
wb%>%
select(IT.CEL.SETS,SP.DYN.TO65.MA.ZS)%>%
scale()->wbsimp #Use numeric data
wbsimp%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=IT.CEL.SETS,y=SP.DYN.TO65.MA.ZS))+geom_point()
wb%>%
select(IT.CEL.SETS,SP.DYN.TO65.MA.ZS)%>%
scale()->wbsimp #Use numeric data
wbsimp%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=IT.CEL.SETS,y=SP.DYN.TO65.MA.ZS))+geom_point()
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
wb%>%
select(IT.MLT.MAIN.P2,FB.CBK.BRCH.P5)%>%
scale()->wbsimp #Use numeric data
wbsimp%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=IT.MLT.MAIN.P2,y=FB.CBK.BRCH.P5))+geom_point()
wb%>%
select(IT.MLT.MAIN.P2,FB.CBK.BRCH.P5)%>%
scale()->wbsimp #Use numeric data
wbsimp%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=IT.MLT.MAIN.P2,y=FB.CBK.BRCH.P5))+geom_point()
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
ggpairs(select(wb,sample(3:67,size = 5,replace = F)))
wb%>%
select(IT.NET.USER.ZS,SH.ANM.NPRG.ZS)%>%
scale()->wbsimp #Use numeric data
wbsimp%>% #Standardise
prcomp()->pca #Compute PCs
wbsimpPC<-augment(pca,wbsimp) #Add PCs to dataframe
ggplot(wbsimpPC,aes(x=IT.MLT.MAIN.P2,y=FB.CBK.BRCH.P5))+geom_point()
ggplot(wbsimpPC,aes(x=IT.NET.USER.ZS,y=SH.ANM.NPRG.ZS))+geom_point()
rho<-cor(wbsimpPC$IT.NET.USER.ZS,wbsimpPC$SH.ANM.NPRG.ZS)
S<-matrix(c(1,rho,rho,1))
W<-eigen(S)
W<-eig(S)
rho<-cor(wbsimpPC$IT.NET.USER.ZS,wbsimpPC$SH.ANM.NPRG.ZS)
S<-matrix(c(1,rho,rho,1))
W<-eig(S)
W<-eig(S)
rho<-cor(wbsimpPC$IT.NET.USER.ZS,wbsimpPC$SH.ANM.NPRG.ZS)
S<-matrix(c(1,rho,rho,1),2,2)
W<-eigen(S)
W
W<-eigen(S)$vectors
theta<-asin(W[1,2])
theta
theta*pi
theta/pi
theta<-pi/4
steps<-20
theta_inc<-seq(0,theta,length.out = steps)
for (i in 1:steps){
rot<-matrix(c(cos(theta_inc[i]),-sin(theta_inc[i]),sin(theta_inc[i]),cos(theta_inc[i])),2,2)
wbtmp<-mutate(wbsimp,c1=rot[1,1]*IT.NET.USER.ZS+rot[1,2]*SH.ANM.NPRG.ZS,c2=rot[2,1]*IT.NET.USER.ZS+rot[2,2]*SH.ANM.NPRG.ZS)
ggplot(wbtmp,aes(x=c1,y=c2))+geom_point()+xlab('')+ylab('')
}
wbsimp
wbsimpPC
theta<-pi/4
steps<-20
theta_inc<-seq(0,theta,length.out = steps)
for (i in 1:steps){
rot<-matrix(c(cos(theta_inc[i]),-sin(theta_inc[i]),sin(theta_inc[i]),cos(theta_inc[i])),2,2)
wbtmp<-mutate(wbsimpPC,c1=rot[1,1]*IT.NET.USER.ZS+rot[1,2]*SH.ANM.NPRG.ZS,c2=rot[2,1]*IT.NET.USER.ZS+rot[2,2]*SH.ANM.NPRG.ZS)
ggplot(wbtmp,aes(x=c1,y=c2))+geom_point()+xlab('')+ylab('')
}
install.packages("animation")
1<-1
i<-1
options(htmltools.dir.version = FALSE)
library(animation)
rot<-matrix(c(cos(theta_inc[i]),-sin(theta_inc[i]),sin(theta_inc[i]),cos(theta_inc[i])),2,2)
wbtmp<-mutate(wbsimpPC,c1=rot[1,1]*IT.NET.USER.ZS+rot[1,2]*SH.ANM.NPRG.ZS,c2=rot[2,1]*IT.NET.USER.ZS+rot[2,2]*SH.ANM.NPRG.ZS)
ggplot(wbtmp,aes(x=c1,y=c2))+geom_point()+xlab('')+ylab('')
i<-10
rot<-matrix(c(cos(theta_inc[i]),-sin(theta_inc[i]),sin(theta_inc[i]),cos(theta_inc[i])),2,2)
wbtmp<-mutate(wbsimpPC,c1=rot[1,1]*IT.NET.USER.ZS+rot[1,2]*SH.ANM.NPRG.ZS,c2=rot[2,1]*IT.NET.USER.ZS+rot[2,2]*SH.ANM.NPRG.ZS)
ggplot(wbtmp,aes(x=c1,y=c2))+geom_point()+xlab('')+ylab('')
install.packages("gifski")
install.packages("gifski")
?gifski
??gifski
options(htmltools.dir.version = FALSE)
library(gifski)
library(tidyverse)
wb<-read_csv('data/WorldBank.csv',na = '..',n_max = 43617)
wb%>%
filter(!(`Country Name`%in%c('India','China')))%>%
select(`Country Name`,`Country Code`,Series=`Series Code`,Value=`2015 [YR2015]`)%>%
pivot_wider(id_cols = 1:2,names_from = Series,values_from=Value)->wb_rs
mis<-apply(wb_rs,2,function(x){sum(is.na(x))})
k<-50
wb_sel<-wb_rs[,(mis<k)]
wb_clean<-wb_sel[complete.cases(wb_sel),]
write_csv(wb_clean,'data/WorldBankClean.csv')
library(knitr)
library(kableExtra)
wb<-read_csv('data/WorldBankClean.csv')
kable(wb,format = 'html')%>%
kable_styling(font_size = 9,bootstrap_options = c("striped","hover","condensed"))%>%
scroll_box(height="400px")
library(tidyverse)
library(broom)
wb<-read_csv('data/WorldBankClean.csv')
wb%>%
select_if(.,is.numeric)%>% #Use numeric data
scale()%>% #Standardise
prcomp()->pca #Compute PCs
wbPC<-augment(pca,wb) #Add PCs to dataframe
pca
pca$sdev
tibble(Variance=pca$sdev^2,Component=1:length(pca$sdev))%>%
ggplot(aes(x=Component,y=Variance))+geom_line()+geom_hline(1)
tibble(Variance=pca$sdev^2,Component=1:length(pca$sdev))%>%
ggplot(aes(x=Component,y=Variance))+geom_line()
?geom_line
?geom_hline
tibble(Variance=pca$sdev^2,Component=1:length(pca$sdev))%>%
ggplot(aes(x=Component,y=Variance))+geom_line(yintercept=1)
tibble(Variance=pca$sdev^2,Component=1:length(pca$sdev))%>%
ggplot(aes(x=Component,y=Variance))+geom_line()+geom_hline(yintercept=1)
tibble(Variance=pca$sdev^2,Component=1:length(pca$sdev))%>%
ggplot(aes(x=Component,y=Variance))+geom_line()+geom_hline(yintercept=1,col='blue')
pca$sdev
7/65
pca$sdev^2
sum(pca$sdev^2[1:2])
sum((pca$sdev^2)[1:2])
sum((pca$sdev^2)[1:65])
sum((pca$sdev^2)[1:2])/65
